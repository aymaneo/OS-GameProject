#pragma once

#ifndef PLATFORMMANAGER_H
#define PLATFORMMANAGER_H
#include "Platform.h"
#include <sextant/Synchronisation/Mutex/Mutex.h>

#define PLATFORM_WIDTH  100
#define PLATFORM_HEIGHT 7


class PlatformManager {
private:
    
    static PlatformManager* instance;
    Platform platform1;
    Platform platform2;    
    Platform ennemy_platform;
    Mutex mutex_platform1;
    Mutex mutex_platform2;
    Mutex mutex_ennemy_platform;

    PlatformManager() : platform1(80, 165), 
                        platform2(100, 180), 
                        ennemy_platform(100, 60), 
                        mutex_platform1(Mutex()),
                        mutex_platform2(Mutex()),
                        mutex_ennemy_platform(Mutex()) {}

public:
    const unsigned char sprite[PLATFORM_WIDTH*PLATFORM_HEIGHT] = 
    {
        3,  67,   2,   3, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160,
      160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160,
      160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160,
      160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160,
      160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160,
      160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160, 160,
        3,   2,  67,   3,   4,   3, 144,   3,  68,  69,  69,  68,  69,  69,  68,  69,
       69,  68,  69,  69,  68,  69,  69,  68,  69,  69,  68,  69,  69,  68,  69,  69,
       68,  69,  69,  68,  69,  69,  68,  69,  69,  68,  69,  69,  68,  69,  69,  68,
       69,  69,  68,  69,  69,  68,  69,  69,  68,  69,  69,  68,  69,  69,  68,  69,
       69,  68,  69,  69,  68,  69,  69,  68,  69,  69,  68,  69,  69,  68,  69,  69,
       68,  69,  69,  68,  69,  69,  68,  69,  69,  68,  69,  69,  68,  69,  69,  68,
       69,  69,  68,  69, 160, 161,   3,   4,   2,  80,  69,  69,  56,  71,  55,  56,
       71,  56,  56,  55,  71,  56,  56,  71,  56,  55,  56,  71,  56,  55,  71,  56,
       56,  56,  71,  55,  56,  56,  71,  56,  55,  56,  71,  56,  55,  71,  56,  56,
       56,  71,  55,  56,  56,  71,  56,  55,  56,  71,  56,  55,  71,  56,  56,  56,
       71,  55,  56,  56,  71,  56,  55,  56,  71,  56,  55,  71,  56,  56,  56,  71,
       55,  56,  56,  71,  56,  55,  56,  71,  56,  55,  71,  56,  56,  56,  71,  55,
       56,  56,  71,  56,  55,  56,  71,  56,  69,  69,  80,   2,   2, 161,  54,  54,
       53,  54,  69,  54,  53,  53,  69,  54,  53,  54,  53,  53,  69,  54,  69,  53,
       54,  54,  53,  69,  53,  69,  53,  54,  69,  53,  54,  53,  69,  54,  53,  54,
       69,  54,  53,  69,  53,  54,  69,  54,  53,  53,  69,  54,  69,  53,  54,  54,
       53,  69,  53,  69,  53,  54,  69,  53,  54,  53,  69,  54,  53,  54,  69,  54,
       53,  69,  53,  54,  69,  54,  53,  53,  69,  54,  69,  53,  54,  54,  53,  69,
       53,  69,  53,  54,  69,  53,  54,  53,  69,  54,  53,  54,  54,  54,  80,   3,
        2,  80,  68,  67,  68,  67,  67,  68,  68,  68,  67,  68,  67,  68,  68,  67,
       68,  67,  68,  67,  68,  67,  68,  68,  67,  68,  68,  67,  68,  67,  68,  68,
       67,  68,  67,  68,  67,  68,  67,  68,  67,  68,  67,  67,  68,  68,  67,  68,
       67,  68,  67,  68,  67,  68,  68,  67,  68,  67,  68,  67,  68,  68,  67,  68,
       67,  68,  67,  68,  67,  68,  67,  68,  67,  67,  68,  68,  67,  68,  67,  68,
       67,  68,  67,  68,  68,  67,  68,  67,  68,  67,  68,  68,  67,  68,  67,  68,
       67,  67,   3,   2,   3, 161,   3, 161,   2,   3,  80,   2,  80,   2,  80,   2,
       80,   2,  80,   3,  80,   2,  80,   2,  80,   3,  80,   2,  80,   2,  80,   2,
       80,   3,  80,   2,  80,   2,  80,   2,  80,   2,  80,   3,  80,   2,  80,   3,
       80,   2,  80,   2,  80,   2,  80,   2,  80,   2,  80,   2,  80,   3,  80,   2,
       80,   2,  80,   2,  80,   2,  80,   2,  80,   3,  80,   2,  80,   3,  80,   2,
       80,   2,  80,   2,  80,   2,  80,   2,  80,   2,  80,   3,  80,   2,  80,   2,
       80,   2,  80,   2,  96,   3, 144,   3,   2,  80,   2,  80, 161,  80, 161,   3,
      161,   3,   2,   3, 144,   3, 144,   2,   3,   2, 161,   3,   2, 144,   3,   2,
      161,   3,   2,   3, 161,   2,   2, 144,   3,   2,   3, 161,   3,   2, 161,   2,
        2,   3, 161,  80, 161,   3,   2,   3, 161,   3,   2,  96,   3,   2,   3,   2,
      161,   2,   3, 144,   3,   2,   3, 144,   3,   2,   3, 161,   3,   2, 161,   3,
        2, 144,   3,   2,   3, 161,   3,   2,   3, 144,   3,   2,   3,   2, 161,   2,
        3, 144,   3,   2,   3, 144,   3,   2,   2,   2,   2,   2 };
            
    static PlatformManager& getInstance();
    ~PlatformManager();

    static const int platformWidth = PLATFORM_WIDTH;
    static const int platformHeight = PLATFORM_HEIGHT;

    int getPlatform1X();
    int getPlatform1Y();
    void movePlatform1Left();
    void movePlatform1Right();
    int getPlatform2X();
    int getPlatform2Y();
    void movePlatform2Left();
    void movePlatform2Right();
    int getEnnemy_platformX();
    int getEnnemy_platformY();
    void moveEnnemy_platformLeft();
    void moveEnnemy_platformRight();
};


#endif